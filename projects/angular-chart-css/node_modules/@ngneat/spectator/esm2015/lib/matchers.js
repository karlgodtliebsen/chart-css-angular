/** Credit: https://github.com/unindented/custom-jquery-matchers/tree/master/packages/custom-jquery-matchers */
// tslint:disable:no-shadowed-variable
import $ from 'jquery';
import { hex2rgb, isHex, trim } from './internals/rgb-to-hex';
import { isHTMLOptionElementArray, isObject } from './types';
import { isRunningInJsDom } from './utils';
const hasProperty = (actual, expected) => {
    return expected === undefined ? actual !== undefined : actual === expected;
};
const ɵ0 = hasProperty;
const containsProperty = (actual, expected) => {
    return expected === undefined ? true : actual.includes(expected);
};
const ɵ1 = containsProperty;
const checkProperty = (el, prop, predicate) => {
    let pass = false;
    let failing = '';
    for (const key of Object.keys(prop)) {
        const actual = $(el).prop(key);
        const addendum = prop[key] !== undefined ? ` with value '${prop[key]}'` : '';
        pass = predicate(actual, prop[key]);
        failing = !pass ? `'${prop}'${addendum}, but had '${actual}'` : '';
    }
    const message = () => `Expected element${pass ? ' not' : ''} to have property ${failing}`;
    return { pass, message };
};
const ɵ2 = checkProperty;
const hasCss = (el, css) => {
    let prop;
    let value;
    const $el = $(el);
    for (prop in css) {
        if (css.hasOwnProperty(prop)) {
            value = css[prop];
            if (isHex(value)) {
                value = hex2rgb(css[prop]);
            }
            if (value === 'auto' && $el.get(0).style[prop] === 'auto') {
                continue;
            }
            if (trim($el.css(prop)) !== trim(value) && trim(el.style[prop]) !== trim(value)) {
                return false;
            }
        }
    }
    return true;
};
const ɵ3 = hasCss;
const hasSameText = (el, expected, exact = false) => {
    if (expected && Array.isArray(expected)) {
        let actual;
        let pass = false;
        let failing;
        $(el).each((i, e) => {
            actual = exact ? $(e).text() : $.trim($(e).text());
            pass = exact ? actual === expected[i] : actual.includes(expected[i]);
            if (!pass) {
                failing = expected[i];
                return false;
            }
        });
        const message = () => `Expected element${pass ? ' not' : ''} to have ${exact ? 'exact' : ''} text '${failing}', but had '${actual}'`;
        return { pass, message };
    }
    const actual = exact ? $(el).text() : $.trim($(el).text());
    if (expected && typeof expected !== 'string') {
        const pass = expected(actual);
        const message = () => `Expected element${pass ? ' not' : ''} to have ${exact ? 'exact' : ''} text matching '${expected}',` + ` but had '${actual}'`;
        return { pass, message };
    }
    const pass = exact && !Array.isArray(expected) ? actual === expected : actual.indexOf(expected) !== -1;
    const message = () => `Expected element${pass ? ' not' : ''} to have ${exact ? 'exact' : ''} text '${expected}', but had '${actual}'`;
    return { pass, message };
};
const ɵ4 = hasSameText;
const comparator = (func) => () => ({
    compare: func
});
const ɵ5 = comparator;
const ɵ6 = (el) => {
    const actual = $(el).length;
    const pass = actual > 0;
    const message = () => `Expected ${el} element${pass ? ' not' : ''} to exist`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').not.toExist();
 */
export const toExist = comparator(ɵ6);
const ɵ7 = (el, expected) => {
    const actual = $(el).length;
    const pass = actual === expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have length ${expected}, but had ${actual}`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').toHaveLength(3);
 */
export const toHaveLength = comparator(ɵ7);
const ɵ8 = (el, expected) => {
    const actual = $(el).attr('id');
    const pass = actual === expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have ID '${expected}', but had '${actual}'`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').toHaveId('ID');
 */
export const toHaveId = comparator(ɵ8);
const ɵ9 = (el, expected) => {
    if (expected && Array.isArray(expected)) {
        const actual = $(el).attr('class');
        const expectedClasses = expected.join(' ');
        const pass = $(el).hasClass(expectedClasses);
        const message = () => `Expected element${pass ? ' not' : ''} to have value '${expectedClasses}', but had '${actual}'`;
        return { pass, message };
    }
    const actual = $(el).attr('class');
    const pass = $(el).hasClass(expected);
    const message = () => `Expected element${pass ? ' not' : ''} to have class '${expected}', but had '${actual}'`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').toHaveClass('class');
 * expect('.zippy__content').toHaveClass('class a, class b');
 * expect('.zippy__content').toHaveClass(['class a, class b']);
 */
export const toHaveClass = comparator(ɵ9);
const ɵ10 = (el, attr, val) => {
    if (isObject(attr)) {
        let pass = false;
        let failing;
        for (const key of Object.keys(attr)) {
            const actual = $(el).attr(key);
            const addendum = attr[key] !== undefined ? ` with value '${attr[key]}'` : '';
            pass = hasProperty(actual, attr[key]);
            failing = !pass ? `'${attr}'${addendum}, but had '${actual}'` : '';
        }
        const message = () => `Expected element${pass ? ' not' : ''} to have attribute ${failing}`;
        return { pass, message };
    }
    const actual = $(el).attr(attr);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = hasProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have attribute '${attr}'${addendum}, but had '${actual}'`;
    return { pass, message };
};
/**
 * expect(host.query('.zippy')).toHaveAttribute('id', 'zippy');
 */
export const toHaveAttribute = comparator(ɵ10);
const ɵ11 = (el, prop, val) => {
    if (isObject(prop)) {
        return checkProperty(el, prop, hasProperty);
    }
    const actual = $(el).prop(prop);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = hasProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have property '${prop}'${addendum}, but had '${actual}'`;
    return { pass, message };
};
/**
 *  expect(host.query('.checkbox')).toHaveProperty('checked', true);
 *  expect(host.query('.checkbox')).toHaveProperty({checked: true});
 */
export const toHaveProperty = comparator(ɵ11);
const ɵ12 = (el, prop, val) => {
    if (isObject(prop)) {
        return checkProperty(el, prop, containsProperty);
    }
    const actual = $(el).prop(prop);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = containsProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have property '${prop}'${addendum}, but had '${actual}'`;
    return { pass, message };
};
export const toContainProperty = comparator(ɵ12);
const ɵ13 = (el, expected, exact = false) => hasSameText(el, expected, exact);
/**
 *
 * expect('.zippy__content').toHaveText('Content');
 * expect('.zippy__content').toHaveText(['Content A', 'Content B']);
 *
 * expect('.zippy__content').toHaveText((text) => text.includes('..');
 */
export const toHaveText = comparator(ɵ13);
const ɵ14 = (el, expected) => hasSameText(el, expected, true);
export const toHaveExactText = comparator(ɵ14);
export const toContainText = toHaveText;
const ɵ15 = (el, expected) => {
    if (expected && Array.isArray(expected)) {
        let actual;
        let pass = false;
        let failing;
        $(el).each((i, e) => {
            actual = $(e).val();
            pass = actual === expected[i];
            if (!pass) {
                failing = expected[i];
                return false;
            }
        });
        const message = () => `Expected element${pass ? ' not' : ''} to have value '${failing}', but had '${actual}'`;
        return { pass, message };
    }
    const actual = $(el).val();
    const pass = actual === expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have value '${expected}', but had '${actual}'`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').toHaveValue('value');
 * expect('.zippy__content').toHaveValue(['value a', 'value b']);
 */
export const toHaveValue = comparator(ɵ15);
export const toContainValue = toHaveValue;
const ɵ16 = (el, expected) => {
    const pass = hasCss(el, expected);
    const message = () => `Expected element${pass ? ' not' : ''} to have CSS ${JSON.stringify(expected)}`;
    return { pass, message };
};
/**
 *
 *  expect(host.element).toHaveStyle({
 *    backgroundColor: 'rgba(0, 0, 0, 0.1)'
 *  });
 */
export const toHaveStyle = comparator(ɵ16);
const ɵ17 = (el, { data, val }) => {
    const actual = $(el).data(data);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = hasProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have data '${data}'${addendum}, but had '${actual}'`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').toHaveData({data: 'role', val: 'admin'});
 */
export const toHaveData = comparator(ɵ17);
const ɵ18 = el => {
    const pass = $(el).is(':checked');
    const message = () => `Expected element${pass ? ' not' : ''} to be checked`;
    return { pass, message };
};
/**
 *
 * expect('.checkbox').toBeChecked();
 */
export const toBeChecked = comparator(ɵ18);
const ɵ19 = el => {
    const pass = $(el).is(':disabled');
    const message = () => `Expected element${pass ? ' not' : ''} to be disabled`;
    return { pass, message };
};
/**
 *
 * expect('.checkbox').toBeDisabled();
 */
export const toBeDisabled = comparator(ɵ19);
const ɵ20 = el => {
    const pass = $(el).is(':empty');
    const message = () => `Expected element${pass ? ' not' : ''} to be empty`;
    return { pass, message };
};
/**
 * An empty element is an element without child elements or text.
 *
 * expect('div').toBeEmpty();
 */
export const toBeEmpty = comparator(ɵ20);
/**
 * Hidden elements are elements that have:
 * 1. Display property set to "none"
 * 2. Width and height set to 0 (check not applied in jest)
 * 3. A hidden parent element (this also hides child elements)
 * 4. Type equal to "hidden" (only for form elements)
 * 5. A "hidden" attribute
 */
function isHidden(elOrSelector) {
    let el = $(elOrSelector)[0];
    if (!el) {
        return true;
    }
    const hiddenWhen = [
        el => !(el.offsetWidth || el.offsetHeight || el.getClientRects().length),
        el => el.style.display === 'none',
        el => el.style.visibility === 'hidden',
        el => el.type === 'hidden',
        el => el.hasAttribute('hidden')
    ];
    if (isRunningInJsDom()) {
        // When running in JSDOM (Jest), offset-properties and client rects are always reported as 0
        // - hence, let's take a more "naive" approach here. (https://github.com/jsdom/jsdom/issues/135)
        hiddenWhen.shift();
    }
    while (el) {
        if (el === document) {
            break;
        }
        if (hiddenWhen.some(rule => rule(el))) {
            return true;
        }
        el = el.parentNode;
    }
    return false;
}
const ɵ21 = el => {
    const pass = isHidden(el);
    const message = () => `Expected element${pass ? ' not' : ''} to be hidden`;
    return { pass, message };
};
/**
 * Hidden elements are elements that have:
 * 1. Display property set to "none"
 * 2. Width and height set to 0
 * 3. A hidden parent element (this also hides child elements)
 * 4. Type equal to "hidden" (only for form elements)
 * 5. A "hidden" attribute
 *
 * expect('div').toBeHidden();
 *
 */
export const toBeHidden = comparator(ɵ21);
const ɵ22 = el => {
    const pass = $(el).is(':selected');
    const message = () => `Expected element${pass ? ' not' : ''} to be selected`;
    return { pass, message };
};
/**
 * The :selected selector selects option elements that are pre-selected.
 *
 * expect('div').toBeSelected();
 *
 */
export const toBeSelected = comparator(ɵ22);
const ɵ23 = el => {
    const pass = !isHidden(el);
    const message = () => `Expected element${pass ? ' not' : ''} to be visible`;
    return { pass, message };
};
/**
 * Hidden elements are elements that have:
 * 1. Display property set to "none"
 * 2. Width and height set to 0
 * 3. A hidden parent element (this also hides child elements)
 * 4. Type equal to "hidden" (only for form elements)
 * 5. A "hidden" attribute
 *
 * expect('div').toBeVisible();
 *
 */
export const toBeVisible = comparator(ɵ23);
const ɵ24 = el => {
    const element = $(el).get(0);
    const pass = element === element.ownerDocument.activeElement;
    const message = () => `Expected element${pass ? ' not' : ''} to be focused`;
    return { pass, message };
};
/**
 * The :focus selector selects the element that currently has focus.
 *
 * expect('input').toBeFocused();
 */
export const toBeFocused = comparator(ɵ24);
const ɵ25 = (el, expected) => {
    const actual = $(el).filter(expected).length;
    const pass = actual > 0;
    const message = () => `Expected element${pass ? ' not' : ''} to be matched by '${expected}'`;
    return { pass, message };
};
/**
 * Check to see if the set of matched elements matches the given selector
 * returns true if the dom contains the element
 *
 * expect('div').toBeMatchedBy('.js-something')
 */
export const toBeMatchedBy = comparator(ɵ25);
const ɵ26 = (el, selector) => {
    const actual = $(el).find(selector).length;
    const pass = actual > 0;
    const message = () => `Expected element${pass ? ' not' : ''} to contain child '${selector}'`;
    return { pass, message };
};
/**
 *
 * expect('div').toHaveDescendant('.child')
 */
export const toHaveDescendant = comparator(ɵ26);
const ɵ27 = (el, { selector, text }) => {
    const actual = $.trim($(el)
        .find(selector)
        .text());
    if (text && $.isFunction(text.test)) {
        const pass = text.test(actual);
        const message = () => `Expected element${pass ? ' not' : ''} to have descendant '${selector}' with text matching '${text}',` + ` but had '${actual}'`;
        return { pass, message };
    }
    const pass = actual.indexOf(text) !== -1;
    const message = () => `Expected element${pass ? ' not' : ''} to have descendant '${selector}' with text '${text}', but had '${actual}'`;
    return { pass, message };
};
/**
 *
 * expect('div').toHaveDescendantWithText({selector: '.child', text: 'text'})
 */
export const toHaveDescendantWithText = comparator(ɵ27);
const ɵ28 = (el, expected) => {
    if (expected instanceof HTMLOptionElement) {
        const actual = $(el).find(':selected');
        const pass = actual.is($(expected));
        const message = () => `Expected element${pass ? ' not' : ''} to have options '[${expected.outerHTML}]' but had '[${actual[0].outerHTML}]'`;
        return { pass, message };
    }
    if (isHTMLOptionElementArray(expected)) {
        const actual = $(el).find(':selected');
        const pass = actual.length === expected.length && actual.toArray().every((_, index) => $(actual[index]).is(expected[index]));
        const expectedOptionsString = $(expected)
            .get()
            .map(option => option.outerHTML)
            .join(',');
        const actualOptionsString = actual
            .get()
            .map(option => option.outerHTML)
            .join(',');
        const message = () => `Expected element${pass ? ' not' : ''} to have options '[${expectedOptionsString}]' but had '[${actualOptionsString}]'`;
        return { pass, message };
    }
    const actual = $(el).val();
    const pass = JSON.stringify([...actual]) === JSON.stringify([...expected]);
    const expectedOptionsString = Array.isArray(expected)
        ? expected.reduce((acc, val, i) => acc + `${i === expected.length ? '' : ','}${val}`)
        : expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have options '[${expectedOptionsString}]' but had '[${actual}]'`;
    return { pass, message };
};
export const toHaveSelectedOptions = comparator(ɵ28);
export { ɵ0, ɵ1, ɵ2, ɵ3, ɵ4, ɵ5, ɵ6, ɵ7, ɵ8, ɵ9, ɵ10, ɵ11, ɵ12, ɵ13, ɵ14, ɵ15, ɵ16, ɵ17, ɵ18, ɵ19, ɵ20, ɵ21, ɵ22, ɵ23, ɵ24, ɵ25, ɵ26, ɵ27, ɵ28 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0Y2hlcnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9zcGVjdGF0b3Ivc3JjL2xpYi9tYXRjaGVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwrR0FBK0c7QUFDL0csc0NBQXNDO0FBRXRDLE9BQU8sQ0FBQyxNQUFNLFFBQVEsQ0FBQztBQUV2QixPQUFPLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUM5RCxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsUUFBUSxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBQzdELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQWUzQyxNQUFNLFdBQVcsR0FBRyxDQUFDLE1BQWUsRUFBRSxRQUFpQixFQUFXLEVBQUU7SUFDbEUsT0FBTyxRQUFRLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxNQUFNLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxNQUFNLEtBQUssUUFBUSxDQUFDO0FBQzdFLENBQUMsQ0FBQzs7QUFFRixNQUFNLGdCQUFnQixHQUFHLENBQUMsTUFBYyxFQUFFLFFBQWlCLEVBQVcsRUFBRTtJQUN0RSxPQUFPLFFBQVEsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFrQixDQUFDLENBQUM7QUFDN0UsQ0FBQyxDQUFDOztBQUVGLE1BQU0sYUFBYSxHQUFHLENBQ3BCLEVBQWUsRUFDZixJQUFZLEVBQ1osU0FBd0MsRUFDRSxFQUFFO0lBQzVDLElBQUksSUFBSSxHQUFHLEtBQUssQ0FBQztJQUNqQixJQUFJLE9BQU8sR0FBRyxFQUFFLENBQUM7SUFFakIsS0FBSyxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ25DLE1BQU0sTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFF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QUFFLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUMzQixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxLQUFLLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUM7SUFFM0UsTUFBTSxxQkFBcUIsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQztRQUNuRCxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQVcsRUFBRSxHQUFXLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDLEtBQUssUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxFQUFFLENBQUM7UUFDckcsQ0FBQyxDQUFDLFFBQVEsQ0FBQztJQUNiLE1BQU0sT0FBTyxHQUFHLEdBQUcsRUFBRSxDQUFDLG1CQUFtQixJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxzQkFBc0IscUJBQXFCLGdCQUFnQixNQUFNLElBQUksQ0FBQztJQUVqSSxPQUFPLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxDQUFDO0FBQzNCLENBQUM7QUExQ0QsTUFBTSxDQUFDLE1BQU0scUJBQXFCLEdBQUcsVUFBVSxLQTBDN0MsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKiBDcmVkaXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS91bmluZGVudGVkL2N1c3RvbS1qcXVlcnktbWF0Y2hlcnMvdHJlZS9tYXN0ZXIvcGFja2FnZXMvY3VzdG9tLWpxdWVyeS1tYXRjaGVycyAqL1xuLy8gdHNsaW50OmRpc2FibGU6bm8tc2hhZG93ZWQtdmFyaWFibGVcblxuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcblxuaW1wb3J0IHsgaGV4MnJnYiwgaXNIZXgsIHRyaW0gfSBmcm9tICcuL2ludGVybmFscy9yZ2ItdG8taGV4JztcbmltcG9ydCB7IGlzSFRNTE9wdGlvbkVsZW1lbnRBcnJheSwgaXNPYmplY3QgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IGlzUnVubmluZ0luSnNEb20gfSBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21NYXRjaGVyRmFjdG9yeSB7XG4gICgpOiBDdXN0b21NYXRjaGVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEN1c3RvbU1hdGNoZXIge1xuICBjb21wYXJlPFQ+KGFjdHVhbDogVCwgZXhwZWN0ZWQ6IFQsIC4uLmFyZ3M6IGFueVtdKTogQ3VzdG9tTWF0Y2hlclJlc3VsdDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21NYXRjaGVyUmVzdWx0IHtcbiAgcGFzczogYm9vbGVhbjtcbiAgbWVzc2FnZT86IHN0cmluZztcbn1cblxuY29uc3QgaGFzUHJvcGVydHkgPSAoYWN0dWFsOiB1bmtub3duLCBleHBlY3RlZDogdW5rbm93bik6IGJvb2xlYW4gPT4ge1xuICByZXR1cm4gZXhwZWN0ZWQgPT09IHVuZGVmaW5lZCA/IGFjdHVhbCAhPT0gdW5kZWZpbmVkIDogYWN0dWFsID09PSBleHBlY3RlZDtcbn07XG5cbmNvbnN0IGNvbnRhaW5zUHJvcGVydHkgPSAoYWN0dWFsOiBzdHJpbmcsIGV4cGVjdGVkOiB1bmtub3duKTogYm9vbGVhbiA9PiB7XG4gIHJldHVybiBleHBlY3RlZCA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IGFjdHVhbC5pbmNsdWRlcyhleHBlY3RlZCBhcyBzdHJpbmcpO1xufTtcblxuY29uc3QgY2hlY2tQcm9wZXJ0eSA9IChcbiAgZWw6IEhUTUxFbGVtZW50LFxuICBwcm9wOiBvYmplY3QsXG4gIHByZWRpY2F0ZTogKGFjdHVhbCwgZXhwZWN0ZWQpID0+IGJvb2xlYW5cbik6IHsgcGFzczogYm9vbGVhbjsgbWVzc2FnZTogKCkgPT4gc3RyaW5nIH0gPT4ge1xuICBsZXQgcGFzcyA9IGZhbHNlO1xuICBsZXQgZmFpbGluZyA9ICcnO1xuXG4gIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHByb3ApKSB7XG4gICAgY29uc3QgYWN0dWFsID0gJChlbCkucHJvcChrZXkpO1xuICAgIGNvbnN0IGFkZGVuZHVtID0gcHJvcFtrZXldICE9PSB1bmRlZmluZWQgPyBgIHdpdGggdmFsdWUgJyR7cHJvcFtrZXldfSdgIDogJyc7XG5cbiAgICBwYXNzID0gcHJlZGljYXRlKGFjdHVhbCwgcHJvcFtrZXldKTtcbiAgICBmYWlsaW5nID0gIXBhc3MgPyBgJyR7cHJvcH0nJHthZGRlbmR1bX0sIGJ1dCBoYWQgJyR7YWN0dWFsfSdgIDogJyc7XG4gIH1cblxuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBwcm9wZXJ0eSAke2ZhaWxpbmd9YDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59O1xuXG5jb25zdCBoYXNDc3MgPSAoZWw6IEhUTUxFbGVtZW50LCBjc3M6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0pID0+IHtcbiAgbGV0IHByb3A7XG4gIGxldCB2YWx1ZTtcbiAgY29uc3QgJGVsID0gJChlbCk7XG4gIGZvciAocHJvcCBpbiBjc3MpIHtcbiAgICBpZiAoY3NzLmhhc093blByb3BlcnR5KHByb3ApKSB7XG4gICAgICB2YWx1ZSA9IGNzc1twcm9wXTtcblxuICAgICAgaWYgKGlzSGV4KHZhbHVlKSkge1xuICAgICAgICB2YWx1ZSA9IGhleDJyZ2IoY3NzW3Byb3BdKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHZhbHVlID09PSAnYXV0bycgJiYgJGVsLmdldCgwKS5zdHlsZVtwcm9wXSA9PT0gJ2F1dG8nKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAodHJpbSgkZWwuY3NzKHByb3ApKSAhPT0gdHJpbSh2YWx1ZSkgJiYgdHJpbShlbC5zdHlsZVtwcm9wXSkgIT09IHRyaW0odmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn07XG5cbmNvbnN0IGhhc1NhbWVUZXh0ID0gKGVsOiBIVE1MRWxlbWVudCwgZXhwZWN0ZWQ6IHN0cmluZyB8IHN0cmluZ1tdIHwgKChzOiBzdHJpbmcpID0+IGJvb2xlYW4pLCBleGFjdCA9IGZhbHNlKSA9PiB7XG4gIGlmIChleHBlY3RlZCAmJiBBcnJheS5pc0FycmF5KGV4cGVjdGVkKSkge1xuICAgIGxldCBhY3R1YWw6IHN0cmluZztcbiAgICBsZXQgcGFzcyA9IGZhbHNlO1xuICAgIGxldCBmYWlsaW5nOiBzdHJpbmc7XG5cbiAgICAkKGVsKS5lYWNoKChpLCBlKSA9PiB7XG4gICAgICBhY3R1YWwgPSBleGFjdCA/ICQoZSkudGV4dCgpIDogJC50cmltKCQoZSkudGV4dCgpKTtcbiAgICAgIHBhc3MgPSBleGFjdCA/IGFjdHVhbCA9PT0gZXhwZWN0ZWRbaV0gOiBhY3R1YWwuaW5jbHVkZXMoZXhwZWN0ZWRbaV0pO1xuICAgICAgaWYgKCFwYXNzKSB7XG4gICAgICAgIGZhaWxpbmcgPSBleHBlY3RlZFtpXTtcblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSAke2V4YWN0ID8gJ2V4YWN0JyA6ICcnfSB0ZXh0ICcke2ZhaWxpbmd9JywgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG4gIH1cblxuICBjb25zdCBhY3R1YWwgPSBleGFjdCA/ICQoZWwpLnRleHQoKSA6ICQudHJpbSgkKGVsKS50ZXh0KCkpO1xuXG4gIGlmIChleHBlY3RlZCAmJiB0eXBlb2YgZXhwZWN0ZWQgIT09ICdzdHJpbmcnKSB7XG4gICAgY29uc3QgcGFzcyA9IGV4cGVjdGVkKGFjdHVhbCk7XG4gICAgY29uc3QgbWVzc2FnZSA9ICgpID0+XG4gICAgICBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlICR7ZXhhY3QgPyAnZXhhY3QnIDogJyd9IHRleHQgbWF0Y2hpbmcgJyR7ZXhwZWN0ZWR9JyxgICsgYCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICAgIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbiAgfVxuXG4gIGNvbnN0IHBhc3MgPSBleGFjdCAmJiAhQXJyYXkuaXNBcnJheShleHBlY3RlZCkgPyBhY3R1YWwgPT09IGV4cGVjdGVkIDogYWN0dWFsLmluZGV4T2YoZXhwZWN0ZWQpICE9PSAtMTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgJHtleGFjdCA/ICdleGFjdCcgOiAnJ30gdGV4dCAnJHtleHBlY3RlZH0nLCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59O1xuXG5jb25zdCBjb21wYXJhdG9yID0gKGZ1bmMpOiBDdXN0b21NYXRjaGVyRmFjdG9yeSA9PiAoKSA9PiAoe1xuICBjb21wYXJlOiBmdW5jXG59KTtcblxuLyoqXG4gKlxuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS5ub3QudG9FeGlzdCgpO1xuICovXG5leHBvcnQgY29uc3QgdG9FeGlzdCA9IGNvbXBhcmF0b3IoKGVsOiBzdHJpbmcgfCBFbGVtZW50KSA9PiB7XG4gIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmxlbmd0aDtcbiAgY29uc3QgcGFzcyA9IGFjdHVhbCA+IDA7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgJHtlbH0gZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBleGlzdGA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICpcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50JykudG9IYXZlTGVuZ3RoKDMpO1xuICovXG5leHBvcnQgY29uc3QgdG9IYXZlTGVuZ3RoID0gY29tcGFyYXRvcigoZWw6IHN0cmluZywgZXhwZWN0ZWQ6IG51bWJlcikgPT4ge1xuICBjb25zdCBhY3R1YWwgPSAkKGVsKS5sZW5ndGg7XG4gIGNvbnN0IHBhc3MgPSBhY3R1YWwgPT09IGV4cGVjdGVkO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBsZW5ndGggJHtleHBlY3RlZH0sIGJ1dCBoYWQgJHthY3R1YWx9YDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKlxuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS50b0hhdmVJZCgnSUQnKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvSGF2ZUlkID0gY29tcGFyYXRvcigoZWwsIGV4cGVjdGVkKSA9PiB7XG4gIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmF0dHIoJ2lkJyk7XG4gIGNvbnN0IHBhc3MgPSBhY3R1YWwgPT09IGV4cGVjdGVkO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBJRCAnJHtleHBlY3RlZH0nLCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKlxuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS50b0hhdmVDbGFzcygnY2xhc3MnKTtcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50JykudG9IYXZlQ2xhc3MoJ2NsYXNzIGEsIGNsYXNzIGInKTtcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50JykudG9IYXZlQ2xhc3MoWydjbGFzcyBhLCBjbGFzcyBiJ10pO1xuICovXG5leHBvcnQgY29uc3QgdG9IYXZlQ2xhc3MgPSBjb21wYXJhdG9yKChlbCwgZXhwZWN0ZWQ6IHN0cmluZyB8IHN0cmluZ1tdKSA9PiB7XG4gIGlmIChleHBlY3RlZCAmJiBBcnJheS5pc0FycmF5KGV4cGVjdGVkKSkge1xuICAgIGNvbnN0IGFjdHVhbDogc3RyaW5nID0gJChlbCkuYXR0cignY2xhc3MnKTtcbiAgICBjb25zdCBleHBlY3RlZENsYXNzZXMgPSBleHBlY3RlZC5qb2luKCcgJyk7XG4gICAgY29uc3QgcGFzcyA9ICQoZWwpLmhhc0NsYXNzKGV4cGVjdGVkQ2xhc3Nlcyk7XG4gICAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgdmFsdWUgJyR7ZXhwZWN0ZWRDbGFzc2VzfScsIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gICAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xuICB9XG5cbiAgY29uc3QgYWN0dWFsID0gJChlbCkuYXR0cignY2xhc3MnKTtcbiAgY29uc3QgcGFzcyA9ICQoZWwpLmhhc0NsYXNzKGV4cGVjdGVkKTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgY2xhc3MgJyR7ZXhwZWN0ZWR9JywgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICogZXhwZWN0KGhvc3QucXVlcnkoJy56aXBweScpKS50b0hhdmVBdHRyaWJ1dGUoJ2lkJywgJ3ppcHB5Jyk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0hhdmVBdHRyaWJ1dGUgPSBjb21wYXJhdG9yKChlbCwgYXR0cjogc3RyaW5nIHwgb2JqZWN0LCB2YWwpID0+IHtcbiAgaWYgKGlzT2JqZWN0KGF0dHIpKSB7XG4gICAgbGV0IHBhc3MgPSBmYWxzZTtcbiAgICBsZXQgZmFpbGluZzogc3RyaW5nO1xuXG4gICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoYXR0cikpIHtcbiAgICAgIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmF0dHIoa2V5KTtcbiAgICAgIGNvbnN0IGFkZGVuZHVtID0gYXR0cltrZXldICE9PSB1bmRlZmluZWQgPyBgIHdpdGggdmFsdWUgJyR7YXR0cltrZXldfSdgIDogJyc7XG4gICAgICBwYXNzID0gaGFzUHJvcGVydHkoYWN0dWFsLCBhdHRyW2tleV0pO1xuICAgICAgZmFpbGluZyA9ICFwYXNzID8gYCcke2F0dHJ9JyR7YWRkZW5kdW19LCBidXQgaGFkICcke2FjdHVhbH0nYCA6ICcnO1xuICAgIH1cbiAgICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBhdHRyaWJ1dGUgJHtmYWlsaW5nfWA7XG5cbiAgICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG4gIH1cblxuICBjb25zdCBhY3R1YWwgPSAkKGVsKS5hdHRyKGF0dHIpO1xuICBjb25zdCBhZGRlbmR1bSA9IHZhbCAhPT0gdW5kZWZpbmVkID8gYCB3aXRoIHZhbHVlICcke3ZhbH0nYCA6ICcnO1xuICBjb25zdCBwYXNzID0gaGFzUHJvcGVydHkoYWN0dWFsLCB2YWwpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBhdHRyaWJ1dGUgJyR7YXR0cn0nJHthZGRlbmR1bX0sIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqICBleHBlY3QoaG9zdC5xdWVyeSgnLmNoZWNrYm94JykpLnRvSGF2ZVByb3BlcnR5KCdjaGVja2VkJywgdHJ1ZSk7XG4gKiAgZXhwZWN0KGhvc3QucXVlcnkoJy5jaGVja2JveCcpKS50b0hhdmVQcm9wZXJ0eSh7Y2hlY2tlZDogdHJ1ZX0pO1xuICovXG5leHBvcnQgY29uc3QgdG9IYXZlUHJvcGVydHkgPSBjb21wYXJhdG9yKChlbCwgcHJvcCwgdmFsKSA9PiB7XG4gIGlmIChpc09iamVjdChwcm9wKSkge1xuICAgIHJldHVybiBjaGVja1Byb3BlcnR5KGVsLCBwcm9wLCBoYXNQcm9wZXJ0eSk7XG4gIH1cblxuICBjb25zdCBhY3R1YWwgPSAkKGVsKS5wcm9wKHByb3ApO1xuICBjb25zdCBhZGRlbmR1bSA9IHZhbCAhPT0gdW5kZWZpbmVkID8gYCB3aXRoIHZhbHVlICcke3ZhbH0nYCA6ICcnO1xuICBjb25zdCBwYXNzID0gaGFzUHJvcGVydHkoYWN0dWFsLCB2YWwpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBwcm9wZXJ0eSAnJHtwcm9wfScke2FkZGVuZHVtfSwgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbmV4cG9ydCBjb25zdCB0b0NvbnRhaW5Qcm9wZXJ0eSA9IGNvbXBhcmF0b3IoKGVsLCBwcm9wLCB2YWwpID0+IHtcbiAgaWYgKGlzT2JqZWN0KHByb3ApKSB7XG4gICAgcmV0dXJuIGNoZWNrUHJvcGVydHkoZWwsIHByb3AsIGNvbnRhaW5zUHJvcGVydHkpO1xuICB9XG5cbiAgY29uc3QgYWN0dWFsID0gJChlbCkucHJvcChwcm9wKTtcbiAgY29uc3QgYWRkZW5kdW0gPSB2YWwgIT09IHVuZGVmaW5lZCA/IGAgd2l0aCB2YWx1ZSAnJHt2YWx9J2AgOiAnJztcbiAgY29uc3QgcGFzcyA9IGNvbnRhaW5zUHJvcGVydHkoYWN0dWFsLCB2YWwpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBwcm9wZXJ0eSAnJHtwcm9wfScke2FkZGVuZHVtfSwgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICpcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50JykudG9IYXZlVGV4dCgnQ29udGVudCcpO1xuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS50b0hhdmVUZXh0KFsnQ29udGVudCBBJywgJ0NvbnRlbnQgQiddKTtcbiAqXG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZVRleHQoKHRleHQpID0+IHRleHQuaW5jbHVkZXMoJy4uJyk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0hhdmVUZXh0ID0gY29tcGFyYXRvcigoZWwsIGV4cGVjdGVkLCBleGFjdCA9IGZhbHNlKSA9PiBoYXNTYW1lVGV4dChlbCwgZXhwZWN0ZWQsIGV4YWN0KSk7XG5cbmV4cG9ydCBjb25zdCB0b0hhdmVFeGFjdFRleHQgPSBjb21wYXJhdG9yKChlbCwgZXhwZWN0ZWQpID0+IGhhc1NhbWVUZXh0KGVsLCBleHBlY3RlZCwgdHJ1ZSkpO1xuXG5leHBvcnQgY29uc3QgdG9Db250YWluVGV4dCA9IHRvSGF2ZVRleHQ7XG5cbi8qKlxuICpcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50JykudG9IYXZlVmFsdWUoJ3ZhbHVlJyk7XG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZVZhbHVlKFsndmFsdWUgYScsICd2YWx1ZSBiJ10pO1xuICovXG5leHBvcnQgY29uc3QgdG9IYXZlVmFsdWUgPSBjb21wYXJhdG9yKChlbCwgZXhwZWN0ZWQpID0+IHtcbiAgaWYgKGV4cGVjdGVkICYmIEFycmF5LmlzQXJyYXkoZXhwZWN0ZWQpKSB7XG4gICAgbGV0IGFjdHVhbDogc3RyaW5nO1xuICAgIGxldCBwYXNzID0gZmFsc2U7XG4gICAgbGV0IGZhaWxpbmc6IHN0cmluZztcblxuICAgICQoZWwpLmVhY2goKGksIGUpID0+IHtcbiAgICAgIGFjdHVhbCA9ICQoZSkudmFsKCk7XG4gICAgICBwYXNzID0gYWN0dWFsID09PSBleHBlY3RlZFtpXTtcbiAgICAgIGlmICghcGFzcykge1xuICAgICAgICBmYWlsaW5nID0gZXhwZWN0ZWRbaV07XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgdmFsdWUgJyR7ZmFpbGluZ30nLCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICAgIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbiAgfVxuXG4gIGNvbnN0IGFjdHVhbCA9ICQoZWwpLnZhbCgpO1xuICBjb25zdCBwYXNzID0gYWN0dWFsID09PSBleHBlY3RlZDtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgdmFsdWUgJyR7ZXhwZWN0ZWR9JywgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbmV4cG9ydCBjb25zdCB0b0NvbnRhaW5WYWx1ZSA9IHRvSGF2ZVZhbHVlO1xuXG4vKipcbiAqXG4gKiAgZXhwZWN0KGhvc3QuZWxlbWVudCkudG9IYXZlU3R5bGUoe1xuICogICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgwLCAwLCAwLCAwLjEpJ1xuICogIH0pO1xuICovXG5leHBvcnQgY29uc3QgdG9IYXZlU3R5bGUgPSBjb21wYXJhdG9yKChlbCwgZXhwZWN0ZWQpID0+IHtcbiAgY29uc3QgcGFzcyA9IGhhc0NzcyhlbCwgZXhwZWN0ZWQpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBDU1MgJHtKU09OLnN0cmluZ2lmeShleHBlY3RlZCl9YDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKlxuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS50b0hhdmVEYXRhKHtkYXRhOiAncm9sZScsIHZhbDogJ2FkbWluJ30pO1xuICovXG5leHBvcnQgY29uc3QgdG9IYXZlRGF0YSA9IGNvbXBhcmF0b3IoKGVsLCB7IGRhdGEsIHZhbCB9KSA9PiB7XG4gIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmRhdGEoZGF0YSk7XG4gIGNvbnN0IGFkZGVuZHVtID0gdmFsICE9PSB1bmRlZmluZWQgPyBgIHdpdGggdmFsdWUgJyR7dmFsfSdgIDogJyc7XG4gIGNvbnN0IHBhc3MgPSBoYXNQcm9wZXJ0eShhY3R1YWwsIHZhbCk7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIGRhdGEgJyR7ZGF0YX0nJHthZGRlbmR1bX0sIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqXG4gKiBleHBlY3QoJy5jaGVja2JveCcpLnRvQmVDaGVja2VkKCk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0JlQ2hlY2tlZCA9IGNvbXBhcmF0b3IoZWwgPT4ge1xuICBjb25zdCBwYXNzID0gJChlbCkuaXMoJzpjaGVja2VkJyk7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBiZSBjaGVja2VkYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKlxuICogZXhwZWN0KCcuY2hlY2tib3gnKS50b0JlRGlzYWJsZWQoKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVEaXNhYmxlZCA9IGNvbXBhcmF0b3IoZWwgPT4ge1xuICBjb25zdCBwYXNzID0gJChlbCkuaXMoJzpkaXNhYmxlZCcpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgZGlzYWJsZWRgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqIEFuIGVtcHR5IGVsZW1lbnQgaXMgYW4gZWxlbWVudCB3aXRob3V0IGNoaWxkIGVsZW1lbnRzIG9yIHRleHQuXG4gKlxuICogZXhwZWN0KCdkaXYnKS50b0JlRW1wdHkoKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVFbXB0eSA9IGNvbXBhcmF0b3IoZWwgPT4ge1xuICBjb25zdCBwYXNzID0gJChlbCkuaXMoJzplbXB0eScpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgZW1wdHlgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqIEhpZGRlbiBlbGVtZW50cyBhcmUgZWxlbWVudHMgdGhhdCBoYXZlOlxuICogMS4gRGlzcGxheSBwcm9wZXJ0eSBzZXQgdG8gXCJub25lXCJcbiAqIDIuIFdpZHRoIGFuZCBoZWlnaHQgc2V0IHRvIDAgKGNoZWNrIG5vdCBhcHBsaWVkIGluIGplc3QpXG4gKiAzLiBBIGhpZGRlbiBwYXJlbnQgZWxlbWVudCAodGhpcyBhbHNvIGhpZGVzIGNoaWxkIGVsZW1lbnRzKVxuICogNC4gVHlwZSBlcXVhbCB0byBcImhpZGRlblwiIChvbmx5IGZvciBmb3JtIGVsZW1lbnRzKVxuICogNS4gQSBcImhpZGRlblwiIGF0dHJpYnV0ZVxuICovXG5mdW5jdGlvbiBpc0hpZGRlbihlbE9yU2VsZWN0b3I6IEhUTUxFbGVtZW50IHwgc3RyaW5nKTogYm9vbGVhbiB7XG4gIGxldCBlbCA9ICQoZWxPclNlbGVjdG9yKVswXTtcblxuICBpZiAoIWVsKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBjb25zdCBoaWRkZW5XaGVuID0gW1xuICAgIGVsID0+ICEoZWwub2Zmc2V0V2lkdGggfHwgZWwub2Zmc2V0SGVpZ2h0IHx8IGVsLmdldENsaWVudFJlY3RzKCkubGVuZ3RoKSxcbiAgICBlbCA9PiBlbC5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScsXG4gICAgZWwgPT4gZWwuc3R5bGUudmlzaWJpbGl0eSA9PT0gJ2hpZGRlbicsXG4gICAgZWwgPT4gZWwudHlwZSA9PT0gJ2hpZGRlbicsXG4gICAgZWwgPT4gZWwuaGFzQXR0cmlidXRlKCdoaWRkZW4nKVxuICBdO1xuXG4gIGlmIChpc1J1bm5pbmdJbkpzRG9tKCkpIHtcbiAgICAvLyBXaGVuIHJ1bm5pbmcgaW4gSlNET00gKEplc3QpLCBvZmZzZXQtcHJvcGVydGllcyBhbmQgY2xpZW50IHJlY3RzIGFyZSBhbHdheXMgcmVwb3J0ZWQgYXMgMFxuICAgIC8vIC0gaGVuY2UsIGxldCdzIHRha2UgYSBtb3JlIFwibmFpdmVcIiBhcHByb2FjaCBoZXJlLiAoaHR0cHM6Ly9naXRodWIuY29tL2pzZG9tL2pzZG9tL2lzc3Vlcy8xMzUpXG4gICAgaGlkZGVuV2hlbi5zaGlmdCgpO1xuICB9XG5cbiAgd2hpbGUgKGVsKSB7XG4gICAgaWYgKGVsID09PSBkb2N1bWVudCkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgaWYgKGhpZGRlbldoZW4uc29tZShydWxlID0+IHJ1bGUoZWwpKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgZWwgPSBlbC5wYXJlbnROb2RlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIEhpZGRlbiBlbGVtZW50cyBhcmUgZWxlbWVudHMgdGhhdCBoYXZlOlxuICogMS4gRGlzcGxheSBwcm9wZXJ0eSBzZXQgdG8gXCJub25lXCJcbiAqIDIuIFdpZHRoIGFuZCBoZWlnaHQgc2V0IHRvIDBcbiAqIDMuIEEgaGlkZGVuIHBhcmVudCBlbGVtZW50ICh0aGlzIGFsc28gaGlkZXMgY2hpbGQgZWxlbWVudHMpXG4gKiA0LiBUeXBlIGVxdWFsIHRvIFwiaGlkZGVuXCIgKG9ubHkgZm9yIGZvcm0gZWxlbWVudHMpXG4gKiA1LiBBIFwiaGlkZGVuXCIgYXR0cmlidXRlXG4gKlxuICogZXhwZWN0KCdkaXYnKS50b0JlSGlkZGVuKCk7XG4gKlxuICovXG5leHBvcnQgY29uc3QgdG9CZUhpZGRlbiA9IGNvbXBhcmF0b3IoZWwgPT4ge1xuICBjb25zdCBwYXNzID0gaXNIaWRkZW4oZWwpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgaGlkZGVuYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKiBUaGUgOnNlbGVjdGVkIHNlbGVjdG9yIHNlbGVjdHMgb3B0aW9uIGVsZW1lbnRzIHRoYXQgYXJlIHByZS1zZWxlY3RlZC5cbiAqXG4gKiBleHBlY3QoJ2RpdicpLnRvQmVTZWxlY3RlZCgpO1xuICpcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVTZWxlY3RlZCA9IGNvbXBhcmF0b3IoZWwgPT4ge1xuICBjb25zdCBwYXNzID0gJChlbCkuaXMoJzpzZWxlY3RlZCcpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgc2VsZWN0ZWRgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqIEhpZGRlbiBlbGVtZW50cyBhcmUgZWxlbWVudHMgdGhhdCBoYXZlOlxuICogMS4gRGlzcGxheSBwcm9wZXJ0eSBzZXQgdG8gXCJub25lXCJcbiAqIDIuIFdpZHRoIGFuZCBoZWlnaHQgc2V0IHRvIDBcbiAqIDMuIEEgaGlkZGVuIHBhcmVudCBlbGVtZW50ICh0aGlzIGFsc28gaGlkZXMgY2hpbGQgZWxlbWVudHMpXG4gKiA0LiBUeXBlIGVxdWFsIHRvIFwiaGlkZGVuXCIgKG9ubHkgZm9yIGZvcm0gZWxlbWVudHMpXG4gKiA1LiBBIFwiaGlkZGVuXCIgYXR0cmlidXRlXG4gKlxuICogZXhwZWN0KCdkaXYnKS50b0JlVmlzaWJsZSgpO1xuICpcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVWaXNpYmxlID0gY29tcGFyYXRvcihlbCA9PiB7XG4gIGNvbnN0IHBhc3MgPSAhaXNIaWRkZW4oZWwpO1xuXG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBiZSB2aXNpYmxlYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKiBUaGUgOmZvY3VzIHNlbGVjdG9yIHNlbGVjdHMgdGhlIGVsZW1lbnQgdGhhdCBjdXJyZW50bHkgaGFzIGZvY3VzLlxuICpcbiAqIGV4cGVjdCgnaW5wdXQnKS50b0JlRm9jdXNlZCgpO1xuICovXG5leHBvcnQgY29uc3QgdG9CZUZvY3VzZWQgPSBjb21wYXJhdG9yKGVsID0+IHtcbiAgY29uc3QgZWxlbWVudCA9ICQoZWwpLmdldCgwKTtcbiAgY29uc3QgcGFzcyA9IGVsZW1lbnQgPT09IGVsZW1lbnQub3duZXJEb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgZm9jdXNlZGA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICogQ2hlY2sgdG8gc2VlIGlmIHRoZSBzZXQgb2YgbWF0Y2hlZCBlbGVtZW50cyBtYXRjaGVzIHRoZSBnaXZlbiBzZWxlY3RvclxuICogcmV0dXJucyB0cnVlIGlmIHRoZSBkb20gY29udGFpbnMgdGhlIGVsZW1lbnRcbiAqXG4gKiBleHBlY3QoJ2RpdicpLnRvQmVNYXRjaGVkQnkoJy5qcy1zb21ldGhpbmcnKVxuICovXG5leHBvcnQgY29uc3QgdG9CZU1hdGNoZWRCeSA9IGNvbXBhcmF0b3IoKGVsLCBleHBlY3RlZCkgPT4ge1xuICBjb25zdCBhY3R1YWwgPSAkKGVsKS5maWx0ZXIoZXhwZWN0ZWQpLmxlbmd0aDtcbiAgY29uc3QgcGFzcyA9IGFjdHVhbCA+IDA7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBiZSBtYXRjaGVkIGJ5ICcke2V4cGVjdGVkfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqXG4gKiBleHBlY3QoJ2RpdicpLnRvSGF2ZURlc2NlbmRhbnQoJy5jaGlsZCcpXG4gKi9cbmV4cG9ydCBjb25zdCB0b0hhdmVEZXNjZW5kYW50ID0gY29tcGFyYXRvcigoZWwsIHNlbGVjdG9yKSA9PiB7XG4gIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmZpbmQoc2VsZWN0b3IpLmxlbmd0aDtcbiAgY29uc3QgcGFzcyA9IGFjdHVhbCA+IDA7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBjb250YWluIGNoaWxkICcke3NlbGVjdG9yfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqXG4gKiBleHBlY3QoJ2RpdicpLnRvSGF2ZURlc2NlbmRhbnRXaXRoVGV4dCh7c2VsZWN0b3I6ICcuY2hpbGQnLCB0ZXh0OiAndGV4dCd9KVxuICovXG5leHBvcnQgY29uc3QgdG9IYXZlRGVzY2VuZGFudFdpdGhUZXh0ID0gY29tcGFyYXRvcigoZWwsIHsgc2VsZWN0b3IsIHRleHQgfSkgPT4ge1xuICBjb25zdCBhY3R1YWwgPSAkLnRyaW0oXG4gICAgJChlbClcbiAgICAgIC5maW5kKHNlbGVjdG9yKVxuICAgICAgLnRleHQoKVxuICApO1xuICBpZiAodGV4dCAmJiAkLmlzRnVuY3Rpb24odGV4dC50ZXN0KSkge1xuICAgIGNvbnN0IHBhc3MgPSB0ZXh0LnRlc3QoYWN0dWFsKTtcbiAgICBjb25zdCBtZXNzYWdlID0gKCkgPT5cbiAgICAgIGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgZGVzY2VuZGFudCAnJHtzZWxlY3Rvcn0nIHdpdGggdGV4dCBtYXRjaGluZyAnJHt0ZXh0fScsYCArIGAgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG4gIH1cbiAgY29uc3QgcGFzcyA9IGFjdHVhbC5pbmRleE9mKHRleHQpICE9PSAtMTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgZGVzY2VuZGFudCAnJHtzZWxlY3Rvcn0nIHdpdGggdGV4dCAnJHt0ZXh0fScsIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG5leHBvcnQgY29uc3QgdG9IYXZlU2VsZWN0ZWRPcHRpb25zID0gY29tcGFyYXRvcigoZWwsIGV4cGVjdGVkKSA9PiB7XG4gIGlmIChleHBlY3RlZCBpbnN0YW5jZW9mIEhUTUxPcHRpb25FbGVtZW50KSB7XG4gICAgY29uc3QgYWN0dWFsID0gJChlbCkuZmluZCgnOnNlbGVjdGVkJyk7XG5cbiAgICBjb25zdCBwYXNzID0gYWN0dWFsLmlzKCQoZXhwZWN0ZWQpKTtcblxuICAgIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PlxuICAgICAgYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBvcHRpb25zICdbJHtleHBlY3RlZC5vdXRlckhUTUx9XScgYnV0IGhhZCAnWyR7YWN0dWFsWzBdLm91dGVySFRNTH1dJ2A7XG5cbiAgICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG4gIH1cblxuICBpZiAoaXNIVE1MT3B0aW9uRWxlbWVudEFycmF5KGV4cGVjdGVkKSkge1xuICAgIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmZpbmQoJzpzZWxlY3RlZCcpO1xuXG4gICAgY29uc3QgcGFzcyA9IGFjdHVhbC5sZW5ndGggPT09IGV4cGVjdGVkLmxlbmd0aCAmJiBhY3R1YWwudG9BcnJheSgpLmV2ZXJ5KChfLCBpbmRleCkgPT4gJChhY3R1YWxbaW5kZXhdKS5pcyhleHBlY3RlZFtpbmRleF0pKTtcblxuICAgIGNvbnN0IGV4cGVjdGVkT3B0aW9uc1N0cmluZyA9ICQoZXhwZWN0ZWQpXG4gICAgICAuZ2V0KClcbiAgICAgIC5tYXAob3B0aW9uID0+IG9wdGlvbi5vdXRlckhUTUwpXG4gICAgICAuam9pbignLCcpO1xuXG4gICAgY29uc3QgYWN0dWFsT3B0aW9uc1N0cmluZyA9IGFjdHVhbFxuICAgICAgLmdldCgpXG4gICAgICAubWFwKG9wdGlvbiA9PiBvcHRpb24ub3V0ZXJIVE1MKVxuICAgICAgLmpvaW4oJywnKTtcblxuICAgIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PlxuICAgICAgYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBvcHRpb25zICdbJHtleHBlY3RlZE9wdGlvbnNTdHJpbmd9XScgYnV0IGhhZCAnWyR7YWN0dWFsT3B0aW9uc1N0cmluZ31dJ2A7XG5cbiAgICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG4gIH1cblxuICBjb25zdCBhY3R1YWwgPSAkKGVsKS52YWwoKTtcbiAgY29uc3QgcGFzcyA9IEpTT04uc3RyaW5naWZ5KFsuLi5hY3R1YWxdKSA9PT0gSlNPTi5zdHJpbmdpZnkoWy4uLmV4cGVjdGVkXSk7XG5cbiAgY29uc3QgZXhwZWN0ZWRPcHRpb25zU3RyaW5nID0gQXJyYXkuaXNBcnJheShleHBlY3RlZClcbiAgICA/IGV4cGVjdGVkLnJlZHVjZSgoYWNjOiBzdHJpbmcsIHZhbDogc3RyaW5nLCBpKSA9PiBhY2MgKyBgJHtpID09PSBleHBlY3RlZC5sZW5ndGggPyAnJyA6ICcsJ30ke3ZhbH1gKVxuICAgIDogZXhwZWN0ZWQ7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIG9wdGlvbnMgJ1ske2V4cGVjdGVkT3B0aW9uc1N0cmluZ31dJyBidXQgaGFkICdbJHthY3R1YWx9XSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuIl19